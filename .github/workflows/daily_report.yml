name: Daily Stock Analysis Report

on:
  schedule:
    # å°åŒ—æ™‚é–“é€±ä¸€è‡³é€±äº” 17:15 åŸ·è¡Œ (UTC 09:15)
    # ç¢ºä¿å°è‚¡æ”¶ç›¤æ•¸æ“šå·²åœ¨ Yahoo Finance æ›´æ–°å®Œç•¢
    - cron: '30 5 * * 1-5'
  workflow_dispatch: 
    # å…è¨±æ‰‹å‹•å¾ž GitHub ç¶²é ä»‹é¢è§¸ç™¼

jobs:
  run-analysis:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ æª¢å‡ºç¨‹å¼ç¢¼ (Checkout)
        uses: actions/checkout@v3

      - name: ðŸ è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ðŸ”¤ å®‰è£ä¸­æ–‡å­—é«”èˆ‡ç’°å¢ƒç›¸ä¾å¥—ä»¶
        run: |
          # æ›´æ–° Ubuntu è»Ÿé«”åº«ä¸¦å®‰è£ Google Noto ä¸­æ–‡å­—é«”
          sudo apt-get update
          sudo apt-get install -y fonts-noto-cjk
          
          # æ›´æ–° pip ä¸¦å®‰è£ requirements.txt å…§çš„å¥—ä»¶
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: ðŸ“Š åŸ·è¡Œç›£æŽ§åˆ†æžç¨‹å¼
        env:
          # è®€å–æ‚¨åœ¨ Settings > Secrets ä¸­è¨­å®šçš„ RESEND_API_KEY
          RESEND_API_KEY: ${{ secrets.RESEND_API_KEY }}
        run: python main.py
